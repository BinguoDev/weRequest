/*!
 * weRequest 2.0.7
 * https://github.com/IvinWu/weRequest
 */
module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={sessionName:"session",codeName:"code",loginTrigger:function(){return!1},getSession:function(e){return e},successTrigger:function(){return!0},urlPerfix:"",successData:function(e){return e},doNotCheckSession:!1,errorTitle:"操作失败",errorContent:function(e){return e},reLoginLimit:3,errorCallback:null,reportCGI:!1,mockJson:!1,globalData:!1,sessionExpireKey:"sessionExpireKey"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={session:"",sessionExpire:1/0,code:""}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),u=r(4),a=r(5),i=null;function s(){return new Promise(function(e,t){return!n.default.session&&!n.default.code||o.default.sessionExpireTime&&(new Date).getTime()>n.default.sessionExpire&&(c(),1)?(o.default.doNotCheckSession=!0,l().then(function(){return e()},function(e){return t(e)})):e()})}var f=null;function l(){return f||(f=new Promise(function(e,t){new Promise(function(e,t){console.log("wx.login");var r=(new Date).getTime();wx.login({success:function(r){return r.code?(n.default.code=r.code,e(r.code)):t({title:"登录失败",content:"请稍后重试[code 获取失败]"})},complete:function(){var e=(new Date).getTime();a.default.report("wx_login",r,e)},fail:function(e){return t({title:"登录失败",content:e.errMsg})}})}).then(function(){return f=null,e()}).catch(function(e){return f=null,t(e)})})),f}function c(){n.default.session="",wx.removeStorage({key:o.default.sessionName}),o.default.sessionExpireTime&&o.default.sessionExpireKey&&(n.default.sessionExpire=1/0,wx.removeStorage({key:o.default.sessionExpireKey}))}t.default={main:function(){return new Promise(function(e,t){return s().then(function(){return o.default.doNotCheckSession?Promise.resolve():(i||(i=new Promise(function(e,t){console.log("wx.checkSession()");var r=(new Date).getTime();wx.checkSession({success:function(){return e()},fail:function(){return c(),l().then(function(){return e()},function(e){return t(e)})},complete:function(){var e=(new Date).getTime();a.default.report("wx_checkSession",r,e)}})})),i)},function(e){var r=e.title,n=e.content;return u.default.doError(r,n),t({title:r,content:n})}).then(function(){return e()},function(e){var r=e.title,n=e.content;return u.default.doError(r,n),t({title:r,content:n})})})},setSession:function(e){n.default.session=e,o.default.doNotCheckSession=!0,o.default.sessionExpireTime&&o.default.sessionExpireKey&&(n.default.sessionExpire=(new Date).getTime()+o.default.sessionExpireTime,wx.setStorage({key:o.default.sessionExpireKey,data:String(n.default.sessionExpire)})),wx.setStorage({key:o.default.sessionName,data:n.default.session})},delSession:c}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),u=r(0),a=r(1),i=r(11),s=r(8),f=r(2),l=r(12),c=r(5),d=r(13),p=r(4);function g(e){if(e.startsWith("http"))return e;var t=u.default.urlPerfix;return"function"==typeof u.default.urlPerfix&&(t=u.default.urlPerfix()),t+e}function m(e){return"function"==typeof e.beforeSend&&e.beforeSend(),void 0===e.reLoginCount?e.reLoginCount=0:e.reLoginCount++,e.showLoading&&o.default.show(e.showLoading),e.originUrl||(e.originUrl=e.url,e.url=g(e.url)),e}function y(){var e={};return"function"==typeof u.default.globalData?e=u.default.globalData():"object"==typeof u.default.globalData&&(e=u.default.globalData),e}function v(e){return e=function(e){var t,r,o,i;e.data||(e.data={});var s=a.default.code;a.default.code="",s?e.data=n({},e.data,((t={})[u.default.codeName]=s,t)):a.default.session&&(e.data=n({},e.data,((r={})[u.default.sessionName]=a.default.session,r)));var f=y();return e.data=n({},f,e.data),e.method=e.method||"GET",e.dataType=e.dataType||"json","GET"!==e.method&&(s?e.url=d.default.setParams(e.url,((o={})[u.default.codeName]=s,o)):a.default.session&&(e.url=d.default.setParams(e.url,((i={})[u.default.sessionName]=a.default.session,i))),e.url=d.default.setParams(e.url,f)),c.default.start(e),e}(e),new Promise(function(t,r){wx.request({url:e.url,data:e.data,method:e.method,header:e.header||{},dataType:e.dataType||"json",success:function(e){return t(e)},fail:function(t){return p.default.systemError(e,t),r(t)},complete:function(){"function"==typeof e.complete&&e.complete(),e.showLoading&&o.default.hide()}})})}function h(e){return e=function(e){var t,r,o,i;e.formData||(e.formData={});var s=a.default.code;a.default.code="",s?e.formData=n({},e.formData,((t={})[u.default.codeName]=s,t)):a.default.session&&(e.formData=n({},e.formData,((r={})[u.default.sessionName]=a.default.session,r)));var f=y();return e.formData=n({},f,e.formData),s?e.url=d.default.setParams(e.url,((o={})[u.default.codeName]=s,o)):a.default.session&&(e.url=d.default.setParams(e.url,((i={})[u.default.sessionName]=a.default.session,i))),e.url=d.default.setParams(e.url,f),c.default.start(e),e}(e),new Promise(function(t,r){wx.uploadFile({url:e.url,filePath:e.filePath||"",name:e.name||"",formData:e.formData,success:function(e){return t(e)},fail:function(t){return p.default.systemError(e,t),r(t)},complete:function(){"function"==typeof e.complete&&e.complete(),e.showLoading&&o.default.hide()}})})}t.default={format:g,request:function(e){return new Promise(function(t,r){if(e=m(e),u.default.mockJson){var n=i.default.get(e);if(n){var o=l.default(n,e,"request");return t(o)}}e.cache&&s.default.get(e),f.default.main().then(function(){return v(e)}).then(function(r){var n=l.default(r,e,"request");return t(n)}).catch(function(e){return r(e)})})},uploadFile:function(e){return new Promise(function(t,r){if(e=m(e),u.default.mockJson){var n=i.default.get(e);if(n){var o=l.default(n,e,"uploadFile");return t(o)}}f.default.main().then(function(){return h(e)}).then(function(r){var n=l.default(r,e,"uploadFile");return t(n)}).catch(function(e){return r(e)})})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);function o(e){var t="";if("function"==typeof n.default.errorTitle)try{t=n.default.errorTitle(e.data)}catch(e){}else"string"==typeof n.default.errorTitle&&(t=n.default.errorTitle);var r="";if("function"==typeof n.default.errorContent)try{r=n.default.errorContent(e.data)}catch(e){}else"string"==typeof n.default.errorContent&&(r=n.default.errorContent);return{title:t,content:r}}function u(e,t){wx.showModal({title:e,content:t||"网络或服务异常，请稍后重试",showCancel:!1})}t.default={systemError:function(e,t){"function"==typeof e.fail?e.fail(t):u("",t.errMsg)},logicError:function(e,t){if("function"==typeof e.fail)e.fail(t);else{var r=o(t);u(r.title,r.content)}"function"==typeof n.default.errorCallback&&n.default.errorCallback(e,t),console.error(t)},doError:u,getErrorMsg:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(6);function u(e,t,r){"function"==typeof n.default.reportCGI&&n.default.reportCGI(e,t,r,o.default)}t.default={start:function(e){e._reportStartTime=(new Date).getTime()},end:function(e){e._reportEndTime=(new Date).getTime(),e.report&&e._reportStartTime&&u(e.report,e._reportStartTime,e._reportEndTime)},report:u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);t.default=function(e){return n.default.request(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={show:function(e){wx.showToast({title:"boolean"==typeof e?"加载中":e,icon:"loading",mask:!0,duration:6e4})},hide:function(){wx.hideToast({})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){e.originUrl&&wx.getStorage({key:e.originUrl,success:function(t){(!0===e.cache||"function"==typeof e.cache&&e.cache(t.data))&&"function"==typeof e.success&&e.success(t.data,{isCache:!0}),"function"==typeof e.complete&&e.complete()}})},set:function(e,t){e.originUrl&&(!0===e.cache||"function"==typeof e.cache&&e.cache(t))&&wx.setStorage({key:e.originUrl,data:t})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),o=r(6),u=r(14),a=r(15),i=r(16),s=r(17),f=r(18),l=r(19),c={init:n.default,request:o.default,uploadFile:u.default,setSession:a.default,login:i.default,getSession:s.default,getConfig:f.default,version:l.version};t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(1);t.default=function(e){Object.assign(n.default,e);try{o.default.session=wx.getStorageSync(n.default.sessionName)||""}catch(e){console.error("wx.getStorageSync:fail, can not get session.")}try{o.default.sessionExpire=wx.getStorageSync(n.default.sessionExpireKey||"sessionExpireKey")||1/0}catch(e){console.error("wx.getStorageSync:fail, can not get sessionExpire.")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7);t.default={get:function(e){if(!(n.default.mockJson[e.url]||e.originUrl&&n.default.mockJson[e.originUrl]))return console.error("mock 没有对应接口的数据"),!1;var t=n.default.mockJson[e.url]||(e.originUrl?n.default.mockJson[e.originUrl]:""),r={data:t=JSON.parse(JSON.stringify(t)),statusCode:200};return o.default.hide(),r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),u=r(3),a=r(4),i=r(8),s=r(5),f=r(2);t.default=function(e,t,r){if(200===e.statusCode){if("string"==typeof e.data)try{e.data=JSON.parse(e.data)}catch(r){if(t.catchError)throw new Error(r);return void a.default.logicError(t,e)}if(s.default.end(t),o.default.loginTrigger(e.data)&&void 0!==t.reLoginCount&&t.reLoginCount<o.default.reLoginLimit)f.default.delSession(),"request"===r?u.default.request(t):"uploadFile"===r&&u.default.uploadFile(t);else if(o.default.successTrigger(e.data)){var l="";try{var c=o.default.getSession(e.data);c&&c!==n.default.session&&f.default.setSession(c)}catch(e){console.error("Function getSession occur error: "+e)}try{l=o.default.successData(e.data)}catch(e){console.error("Function successData occur error: "+e)}if(!t.noCacheFlash){if("function"!=typeof t.success)return l;t.success(l)}i.default.set(t,l)}else{if(t.catchError){var d=a.default.getErrorMsg(e);throw new Error(d.content)}a.default.logicError(t,e)}}else{if(t.catchError)throw new Error(e.statusCode.toString());a.default.logicError(t,e)}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.default={setParams:function(e,t){void 0===e&&(e="");var r=e.indexOf("?"),o={};if(r>=0){var u=e.substr(r+1).split("&");u.forEach(function(e,t){var r=u[t].split("=");o[r[0]]=r[1]})}o=n({},o,t);var a=Object.keys(o).map(function(e){return e+"="+encodeURI(o[e])}).join("&");return r>=0?e.substring(0,r+1)+a:e+"?"+a}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);t.default=function(e){return n.default.uploadFile(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.default=function(e){n.default.setSession(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.default=function(){return n.default.main()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.default=function(){return n.default.session}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(1);t.default=function(){return{urlPerfix:n.default.urlPerfix,sessionExpireTime:n.default.sessionExpireTime,sessionExpireKey:n.default.sessionExpireKey,sessionExpire:o.default.sessionExpire}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.version="2.0.7"}]).default;